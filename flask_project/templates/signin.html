<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login page</title>

    <style>
        input {
            width: 200px;
            margin: 5px;
        }

        #togglePassword {
            width: auto;
        }
    </style>
</head>

<body>
    <form>
        <h2 class="login">Login</h2>
        <div class="form-group">
            <label for="email">Email : </label>
            <br>
            <input class="form-control" type="email" id="email">
        </div>
        <div class="form-group">
            <label for="pw">Password : </label>
            <br>
            <input class="form-control" type="password" id="pw">
            <br>
            <input type="checkbox" id="togglePassword"> Show Password
        </div>
        <br>

        <button type="submit" id="signin">Login</button>
    </form>
    <br>
    <p>Forgot your password?</p>
    <button onclick="window.location.href='/forgotpass'">Forgot password</button>
    <p>New user?</p>
    <button onclick="window.location.href='/registration'">Sign up</button>


    <script>
        document.getElementById("togglePassword").addEventListener("change", function () {
            let passwordField = document.getElementById("pw");
            passwordField.type = this.checked ? "text" : "password";
        });

        document.getElementById("signin").addEventListener("click", function (event) {
            event.preventDefault()
            
            let email = document.getElementById("email").value.trim();
            let password = document.getElementById("pw").value;

            if (!email || !password) {
                alert("Please fill the fields");
                return;
            }

            fetch("/signin", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ email, password })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                if (data.message === "Login Successful") {
                    window.location.href = "homepage"; // Redirect to homepage after login
                }
            })
            .catch(error => console.error("Error:", error));
        });

    </script>
</body>

</html>